{% extends "layout.html" %}

{% block title %}
áƒ§áƒ˜áƒ“áƒ•áƒ - áƒ™áƒáƒšáƒáƒ—áƒ
{% endblock %}

{% block main %}
<style>
.cart-container {
    max-width: 800px;
    margin: 2rem auto;
    padding: 0 1rem;
}

.cart-card {
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    overflow: hidden;
}

.cart-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 2rem;
    text-align: center;
}

.cart-item {
    display: flex;
    align-items: center;
    padding: 1.5rem;
    border-bottom: 1px solid #f1f3f4;
}

.cart-item:last-child {
    border-bottom: none;
}

.course-image {
    width: 80px;
    height: 60px;
    border-radius: 8px;
    object-fit: cover;
    margin-right: 1rem;
}

.course-placeholder {
    width: 80px;
    height: 60px;
    background: #f8f9fa;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 1rem;
    font-size: 1.5rem;
}

.course-info {
    flex: 1;
}

.course-name {
    font-weight: 600;
    color: #2d3748;
    margin: 0;
}

.course-price {
    font-weight: 700;
    color: #667eea;
    font-size: 1.1rem;
}

.total-section {
    background: #f8f9fa;
    padding: 2rem;
    text-align: center;
}

.total-price {
    font-size: 2rem;
    font-weight: 700;
    color: #2d3748;
    margin-bottom: 1rem;
}

.checkout-btn {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: none;
    color: white;
    padding: 1rem 3rem;
    border-radius: 50px;
    font-weight: 600;
    font-size: 1.1rem;
    transition: all 0.3s ease;
    min-width: 200px;
}

.checkout-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
    color: white;
}

.empty-cart {
    text-align: center;
    padding: 4rem 2rem;
    color: #718096;
}

.empty-cart i {
    font-size: 4rem;
    margin-bottom: 1rem;
    opacity: 0.5;
}

.promo-section {
    padding: 1.5rem;
    background: #f8f9fa;
    border-top: 1px solid #e2e8f0;
}

.promo-form {
    display: flex;
    gap: 0.5rem;
    max-width: 300px;
    margin: 0 auto;
}

.promo-input {
    flex: 1;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    padding: 0.75rem;
    font-size: 0.9rem;
}

.promo-btn {
    background: #48bb78;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 0.75rem 1rem;
    font-weight: 600;
    transition: all 0.3s ease;
}

.promo-btn:hover {
    background: #38a169;
}
</style>

<div class="cart-container">
    {% if cart and cart|length > 0 %}
        <div class="cart-card">
            <!-- Header -->
            <div class="cart-header">
                <h2>ğŸ›’ áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ™áƒáƒšáƒáƒ—áƒ</h2>
                <p class="mb-0">{{ count if count else 0 }} áƒ™áƒ£áƒ áƒ¡áƒ˜</p>
            </div>

            <!-- Cart Items -->
            <div class="cart-items">
                {% for item in cart %}
                <div class="cart-item">
                    {% if item.image and item.image != '' %}
                        {% if item.image.startswith('http') %}
                            <img src="{{ item.image }}" alt="{{ item.name }}" class="course-image">
                        {% else %}
                            <img src="{{ url_for('static', filename=item.image) }}" alt="{{ item.name }}" class="course-image">
                        {% endif %}
                    {% else %}
                        <div class="course-placeholder">
                            ğŸ“š
                        </div>
                    {% endif %}

                    <div class="course-info">
                        <h5 class="course-name">{{ item.name }}</h5>
                        <p class="text-muted mb-0">{{ item.description[:80] if item.description else 'áƒ™áƒ£áƒ áƒ¡áƒ˜áƒ¡ áƒáƒ¦áƒ¬áƒ”áƒ áƒ' }}...</p>
                    </div>

                    <div class="course-price">
                        {% if item.price == 0 %}áƒ£áƒ¤áƒáƒ¡áƒ{% else %}{{ item.price }}â‚¾{% endif %}
                    </div>
                </div>
                {% endfor %}

                <!-- Promo codes if any -->
                {% if promo and promo|length > 0 %}
                    {% for promo_item in promo %}
                    <div class="cart-item" style="background: #f0fff4;">
                        <div class="course-placeholder" style="background: #48bb78; color: white;">
                            ğŸ
                        </div>
                        <div class="course-info">
                            <h5 class="course-name" style="color: #48bb78;">{{ promo_item.name }}</h5>
                            <p class="text-muted mb-0">áƒáƒ áƒáƒ›áƒ áƒ™áƒáƒ“áƒ˜</p>
                        </div>
                        <div class="course-price" style="color: #48bb78;">
                            -{{ promo_item.value }}â‚¾
                        </div>
                    </div>
                    {% endfor %}
                {% endif %}
            </div>

            <!-- Promo Code Section -->
            <div class="promo-section">
                <form action="/buy" method="post" class="promo-form">
                    <input type="text" name="promo" placeholder="áƒáƒ áƒáƒ›áƒ áƒ™áƒáƒ“áƒ˜" class="promo-input">
                    <button type="submit" class="promo-btn">áƒ’áƒáƒ›áƒáƒ§áƒ”áƒœáƒ”áƒ‘áƒ</button>
                </form>
            </div>

            <!-- Total Section -->
            <div class="total-section">
                <div class="total-price">
                    áƒ¡áƒ£áƒš: {% if total is defined %}{{ total }}â‚¾{% else %}0â‚¾{% endif %}
                </div>

                <form action="/buy" method="post" style="max-width: 400px; margin: 0 auto;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; margin-bottom: 1rem;">
                        <input type="text" name="firstName" placeholder="áƒ¡áƒáƒ®áƒ”áƒšáƒ˜"
                               style="padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px;" required>
                        <input type="text" name="lastName" placeholder="áƒ’áƒ•áƒáƒ áƒ˜"
                               style="padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px;" required>
                    </div>

                    <input type="email" name="email" placeholder="áƒ”áƒš-áƒ¤áƒáƒ¡áƒ¢áƒ"
                           style="width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px; margin-bottom: 1rem;" required>

                    <input type="text" name="address" placeholder="áƒ›áƒ˜áƒ¡áƒáƒ›áƒáƒ áƒ—áƒ˜"
                           style="width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px; margin-bottom: 1rem;" required>

                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 0.75rem; margin-bottom: 1.5rem;">
                        <input type="text" name="city" placeholder="áƒ¥áƒáƒšáƒáƒ¥áƒ˜"
                               style="padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px;" required>
                        <input type="text" name="postalCode" placeholder="áƒ˜áƒœáƒ“áƒ”áƒ¥áƒ¡áƒ˜"
                               style="padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px;" required>
                    </div>

                    <!-- áƒ‘áƒáƒ áƒáƒ—áƒ˜áƒ¡ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜ -->
                    <div style="border-top: 2px solid #e2e8f0; padding-top: 1.5rem; margin-bottom: 1.5rem;">
                        <h6 style="color: #4a5568; margin-bottom: 1rem; font-weight: 600;">ğŸ’³ áƒ‘áƒáƒ áƒáƒ—áƒ˜áƒ¡ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜</h6>

                        <input type="text" name="cardName" placeholder="áƒ‘áƒáƒ áƒáƒ—áƒ˜áƒ¡ áƒ›áƒ¤áƒšáƒáƒ‘áƒ”áƒšáƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜"
                               style="width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px; margin-bottom: 1rem;" required>

                        <input type="text" name="cardNumber" placeholder="áƒ‘áƒáƒ áƒáƒ—áƒ˜áƒ¡ áƒœáƒáƒ›áƒ”áƒ áƒ˜ (1234 5678 9012 3456)"
                               style="width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px; margin-bottom: 1rem;"
                               maxlength="19" pattern="[0-9\s]{13,19}" required>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                            <input type="text" name="cardExpiry" placeholder="MM/YY"
                                   style="padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px;"
                                   maxlength="5" pattern="[0-9]{2}/[0-9]{2}" required>
                            <input type="text" name="cardCVV" placeholder="CVV"
                                   style="padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px;"
                                   maxlength="4" pattern="[0-9]{3,4}" required>
                        </div>
                    </div>

                    <button type="submit" class="checkout-btn">
                        ğŸ’³ áƒ§áƒ˜áƒ“áƒ•áƒ
                    </button>
                </form>

                <div class="mt-3">
                    <a href="/courses" class="text-muted" style="text-decoration: none;">â† áƒ™áƒ£áƒ áƒ¡áƒ”áƒ‘áƒ–áƒ” áƒ“áƒáƒ‘áƒ áƒ£áƒœáƒ”áƒ‘áƒ</a>
                </div>
            </div>
        </div>

    {% else %}
        <!-- Empty Cart -->
        <div class="cart-card">
            <div class="empty-cart">
                <div style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.5;">ğŸ›’</div>
                <h3 style="color: #4a5568; margin-bottom: 1rem;">áƒ—áƒ¥áƒ•áƒ”áƒœáƒ˜ áƒ™áƒáƒšáƒáƒ—áƒ áƒªáƒáƒ áƒ˜áƒ”áƒšáƒ˜áƒ</h3>
                <p style="margin-bottom: 2rem;">áƒ“áƒáƒáƒ›áƒáƒ¢áƒ”áƒ— áƒ™áƒ£áƒ áƒ¡áƒ”áƒ‘áƒ˜ áƒ™áƒáƒšáƒáƒ—áƒáƒ¨áƒ˜ áƒ§áƒ˜áƒ“áƒ•áƒ˜áƒ¡ áƒ“áƒáƒ¡áƒáƒ¬áƒ§áƒ”áƒ‘áƒáƒ“</p>
                <a href="/courses" class="checkout-btn" style="text-decoration: none;">
                    ğŸ“š áƒ™áƒ£áƒ áƒ¡áƒ”áƒ‘áƒ˜áƒ¡ áƒœáƒáƒ®áƒ•áƒ
                </a>
            </div>
        </div>
    {% endif %}
</div>

{% endblock %}

